/*
 * DHCP.c
 *
 *  Created on: Dec 19, 2023
 *      Author: kunal
 *
 *
 */



#include "DHCP.h"

//ment to be used as a client
#define DHCP_Client_Port 68
#define DHCP_Server_Port 67



uint8_t discovery_packet[] =
{
		0x01,0x01,0x06,0x00,0xa2,0x17,0xbb,0x39,0x04,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
		0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x63,0x82,0x53,0x63,
		0x35,0x01,0x01,0x3d,0x07,0x01,0x00,0x00,0x00,0x00,0x00,0x00,0x0c,0x0b,0x4B,0x75,
		0x6E,0x61,0x6C,0x20,0x53,0x61,0x6C,0x76,0x69,0x3c,0x08,0x4d,0x53,0x46,0x54,0x20,0x35,0x2e,
		0x30,0x37,0x0e,0x01,0x03,0x06,0x0f,0x1f,0x21,0x2b,0x2c,0x2e,0x2f,0x77,0x79,0xf9,
		0xfc,0xff
};

void DHCP_Client_Send_Discovery(W5500_Config *config, W5500_Socket_Config *socket_config)
{
	socket_config -> Mode = W5500_Socket_Mode.UDP;
	socket_config -> Destination_Port = DHCP_Server_Port; //48569
	uint8_t Destination_Hardware_Address[] = { 255,255,255,255,255,255};
	uint8_t Destination_IP_Address[] = {255,255,255,255}; //169.254.26.103
	socket_config -> Destination_Hardware_Address = Destination_Hardware_Address;
	socket_config -> Destination_IP_Address = Destination_IP_Address;

	W5500_Socket_UDP_Setup(config, socket_config);

	socket_config->data_len = 292;
	socket_config->data = &discovery_packet[0];
	Send_Packet(config, socket_config);
}
